apply plugin: 'scala'
archivesBaseName = "kafka-streams-scala_${versions.baseScala}"
dependencies {
    api project(':streams')

    api libs.scalaLibrary
    api libs.scalaCollectionCompat

    testImplementation project(':core')
    testImplementation project(':core').sourceSets.test.output
    testImplementation project(':server-common').sourceSets.test.output
    testImplementation project(':streams').sourceSets.test.output
    testImplementation project(':clients').sourceSets.test.output
    testImplementation project(':streams:test-utils')

    testImplementation libs.junitJupiter
    testImplementation libs.easymock
    testImplementation libs.hamcrest
    testRuntimeOnly libs.slf4jlog4j
}

javadoc {
    include "**/org/apache/kafka/streams/scala/**"
}

scaladoc {
    scalaDocOptions.additionalParameters = ["-no-link-warnings"]
}

tasks.create(name: "copyDependantLibs", type: Copy) {
    from (configurations.runtimeClasspath) {
        exclude('kafka-streams*')
    }
    into "$buildDir/dependant-libs-${versions.scala}"
    duplicatesStrategy 'exclude'
}

jar {
    dependsOn 'copyDependantLibs'
}

// spotless 6.14 requires Java 11 at runtime
if (JavaVersion.current().isJava11Compatible()) {
    apply plugin: 'com.diffplug.spotless'
    spotless {
        scala {
            target '**/*.scala'
            scalafmt("$versions.scalafmt").configFile('../../checkstyle/.scalafmt.conf').scalaMajorVersion(versions.baseScala)
            licenseHeaderFile '../../checkstyle/java.header', 'package'
        }
    }
}